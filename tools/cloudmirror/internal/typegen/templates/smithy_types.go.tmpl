// Code generated by CloudMirror from AWS Smithy models. DO NOT EDIT.
// Source: {{.Source}}
// Service: {{.ServiceName}}
// Protocol: {{.Protocol}}
// Generated: {{.GeneratedAt}}

package {{.PackageName}}
{{if or .HasTimeImport .HasXMLImport .HasRegexpImport .HasFmtImport .HasUnixTimestamp}}

import (
{{- if .HasUnixTimestamp}}
	"encoding/json"
{{- end}}
{{- if .HasXMLImport}}
	"encoding/xml"
{{- end}}
{{- if .HasFmtImport}}
	"fmt"
{{- end}}
{{- if .HasRegexpImport}}
	"regexp"
{{- end}}
{{- if .HasTimeImport}}
	"time"
{{- end}}
)
{{end}}
{{if .HasFmtImport}}
// ValidationError represents a field validation error
type ValidationError struct {
	Field   string
	Message string
}

func (e ValidationError) Error() string {
	return fmt.Sprintf("%s: %s", e.Field, e.Message)
}
{{end}}
{{if .HasRegexpImport}}
// Precompiled validation patterns
var (
{{- range $type := .Types}}
{{- range .Fields}}
{{- if .Validation.HasPattern}}
	validate{{$type.Name}}{{.Name}}Pattern = regexp.MustCompile(`{{.Validation.Pattern}}`)
{{- end}}
{{- end}}
{{- end}}
)
{{end}}
{{- if .HasUnixTimestamp}}

// UnixTimestamp is a time.Time that serializes to/from Unix epoch seconds for JSON.
// AWS JSON protocol expects timestamps as numbers (e.g., 1734574653.902), not RFC3339 strings.
type UnixTimestamp time.Time

// MarshalJSON serializes UnixTimestamp as a Unix epoch float64
func (t UnixTimestamp) MarshalJSON() ([]byte, error) {
	return json.Marshal(float64(time.Time(t).UnixNano()) / 1e9)
}

// UnmarshalJSON deserializes a Unix epoch float64 into UnixTimestamp
func (t *UnixTimestamp) UnmarshalJSON(data []byte) error {
	var f float64
	if err := json.Unmarshal(data, &f); err != nil {
		return err
	}
	sec := int64(f)
	nsec := int64((f - float64(sec)) * 1e9)
	*t = UnixTimestamp(time.Unix(sec, nsec))
	return nil
}
{{- end}}
{{if .Enums}}
// Enum type aliases
{{range .Enums}}
type {{.Name}} string
{{end}}
{{end}}
{{range $type := .Types}}
{{- if .Documentation}}
// {{.Name}} {{.Documentation}}
{{- else}}
// {{.Name}} represents the {{.Name}} structure.
{{- end}}
{{- if .IsDeprecated}}
// Deprecated: This type is deprecated.
{{- end}}
type {{.Name}} struct {
{{- if .ResponseElementName}}
	XMLName xml.Name `xml:"{{.ResponseElementName}}"`
{{- end}}
{{- range .Fields}}
	{{.Name}} {{if .UsePointer}}*{{end}}{{.GoType}} `{{.StructTag}}`{{if or .Documentation .ValidationComment}} //{{if .Documentation}} {{.Documentation}}{{end}}{{if .ValidationComment}} {{.ValidationComment}}{{end}}{{end}}
{{- end}}
}
{{if .HasValidation}}
// Validate checks all field constraints and returns any validation errors
func (s *{{.Name}}) Validate() []error {
	var errs []error
{{range .Fields}}
{{- if .Validation.HasConstraints}}
{{- if .Validation.IsPointer}}
	if s.{{.Name}} != nil {
{{- end}}
{{- if and .Validation.HasLength .Validation.IsString}}
{{- if .Validation.IsPointer}}
{{- if and .Validation.LengthMin .Validation.LengthMax}}
		if len(*s.{{.Name}}) < {{.Validation.LengthMin}} || len(*s.{{.Name}}) > {{.Validation.LengthMax}} {
			errs = append(errs, ValidationError{Field: "{{.Name}}", Message: fmt.Sprintf("length must be between {{.Validation.LengthMin}} and {{.Validation.LengthMax}}, got %d", len(*s.{{.Name}}))})
		}
{{- else if .Validation.LengthMin}}
		if len(*s.{{.Name}}) < {{.Validation.LengthMin}} {
			errs = append(errs, ValidationError{Field: "{{.Name}}", Message: fmt.Sprintf("length must be at least {{.Validation.LengthMin}}, got %d", len(*s.{{.Name}}))})
		}
{{- else if .Validation.LengthMax}}
		if len(*s.{{.Name}}) > {{.Validation.LengthMax}} {
			errs = append(errs, ValidationError{Field: "{{.Name}}", Message: fmt.Sprintf("length must be at most {{.Validation.LengthMax}}, got %d", len(*s.{{.Name}}))})
		}
{{- end}}
{{- else}}
{{- if and .Validation.LengthMin .Validation.LengthMax}}
	if len(s.{{.Name}}) < {{.Validation.LengthMin}} || len(s.{{.Name}}) > {{.Validation.LengthMax}} {
		errs = append(errs, ValidationError{Field: "{{.Name}}", Message: fmt.Sprintf("length must be between {{.Validation.LengthMin}} and {{.Validation.LengthMax}}, got %d", len(s.{{.Name}}))})
	}
{{- else if .Validation.LengthMin}}
	if len(s.{{.Name}}) < {{.Validation.LengthMin}} {
		errs = append(errs, ValidationError{Field: "{{.Name}}", Message: fmt.Sprintf("length must be at least {{.Validation.LengthMin}}, got %d", len(s.{{.Name}}))})
	}
{{- else if .Validation.LengthMax}}
	if len(s.{{.Name}}) > {{.Validation.LengthMax}} {
		errs = append(errs, ValidationError{Field: "{{.Name}}", Message: fmt.Sprintf("length must be at most {{.Validation.LengthMax}}, got %d", len(s.{{.Name}}))})
	}
{{- end}}
{{- end}}
{{- end}}
{{- if and .Validation.HasLength .Validation.IsSlice}}
{{- if and .Validation.LengthMin .Validation.LengthMax}}
	if len(s.{{.Name}}) < {{.Validation.LengthMin}} || len(s.{{.Name}}) > {{.Validation.LengthMax}} {
		errs = append(errs, ValidationError{Field: "{{.Name}}", Message: fmt.Sprintf("length must be between {{.Validation.LengthMin}} and {{.Validation.LengthMax}}, got %d", len(s.{{.Name}}))})
	}
{{- else if .Validation.LengthMin}}
	if len(s.{{.Name}}) < {{.Validation.LengthMin}} {
		errs = append(errs, ValidationError{Field: "{{.Name}}", Message: fmt.Sprintf("length must be at least {{.Validation.LengthMin}}, got %d", len(s.{{.Name}}))})
	}
{{- else if .Validation.LengthMax}}
	if len(s.{{.Name}}) > {{.Validation.LengthMax}} {
		errs = append(errs, ValidationError{Field: "{{.Name}}", Message: fmt.Sprintf("length must be at most {{.Validation.LengthMax}}, got %d", len(s.{{.Name}}))})
	}
{{- end}}
{{- end}}
{{- if and .Validation.HasLength .Validation.IsMap}}
{{- if and .Validation.LengthMin .Validation.LengthMax}}
	if len(s.{{.Name}}) < {{.Validation.LengthMin}} || len(s.{{.Name}}) > {{.Validation.LengthMax}} {
		errs = append(errs, ValidationError{Field: "{{.Name}}", Message: fmt.Sprintf("length must be between {{.Validation.LengthMin}} and {{.Validation.LengthMax}}, got %d", len(s.{{.Name}}))})
	}
{{- else if .Validation.LengthMin}}
	if len(s.{{.Name}}) < {{.Validation.LengthMin}} {
		errs = append(errs, ValidationError{Field: "{{.Name}}", Message: fmt.Sprintf("length must be at least {{.Validation.LengthMin}}, got %d", len(s.{{.Name}}))})
	}
{{- else if .Validation.LengthMax}}
	if len(s.{{.Name}}) > {{.Validation.LengthMax}} {
		errs = append(errs, ValidationError{Field: "{{.Name}}", Message: fmt.Sprintf("length must be at most {{.Validation.LengthMax}}, got %d", len(s.{{.Name}}))})
	}
{{- end}}
{{- end}}
{{- if .Validation.HasPattern}}
{{- if .Validation.IsPointer}}
		if !validate{{$type.Name}}{{.Name}}Pattern.MatchString(*s.{{.Name}}) {
			errs = append(errs, ValidationError{Field: "{{.Name}}", Message: "does not match required pattern"})
		}
{{- else}}
	if !validate{{$type.Name}}{{.Name}}Pattern.MatchString(s.{{.Name}}) {
		errs = append(errs, ValidationError{Field: "{{.Name}}", Message: "does not match required pattern"})
	}
{{- end}}
{{- end}}
{{- if and .Validation.HasRange .Validation.IsNumeric}}
{{- if .Validation.IsPointer}}
{{- if and .Validation.RangeMin .Validation.RangeMax}}
		if float64(*s.{{.Name}}) < {{.Validation.RangeMin}} || float64(*s.{{.Name}}) > {{.Validation.RangeMax}} {
			errs = append(errs, ValidationError{Field: "{{.Name}}", Message: fmt.Sprintf("value must be between {{.Validation.RangeMin}} and {{.Validation.RangeMax}}, got %v", *s.{{.Name}})})
		}
{{- else if .Validation.RangeMin}}
		if float64(*s.{{.Name}}) < {{.Validation.RangeMin}} {
			errs = append(errs, ValidationError{Field: "{{.Name}}", Message: fmt.Sprintf("value must be at least {{.Validation.RangeMin}}, got %v", *s.{{.Name}})})
		}
{{- else if .Validation.RangeMax}}
		if float64(*s.{{.Name}}) > {{.Validation.RangeMax}} {
			errs = append(errs, ValidationError{Field: "{{.Name}}", Message: fmt.Sprintf("value must be at most {{.Validation.RangeMax}}, got %v", *s.{{.Name}})})
		}
{{- end}}
{{- else}}
{{- if and .Validation.RangeMin .Validation.RangeMax}}
	if float64(s.{{.Name}}) < {{.Validation.RangeMin}} || float64(s.{{.Name}}) > {{.Validation.RangeMax}} {
		errs = append(errs, ValidationError{Field: "{{.Name}}", Message: fmt.Sprintf("value must be between {{.Validation.RangeMin}} and {{.Validation.RangeMax}}, got %v", s.{{.Name}})})
	}
{{- else if .Validation.RangeMin}}
	if float64(s.{{.Name}}) < {{.Validation.RangeMin}} {
		errs = append(errs, ValidationError{Field: "{{.Name}}", Message: fmt.Sprintf("value must be at least {{.Validation.RangeMin}}, got %v", s.{{.Name}})})
	}
{{- else if .Validation.RangeMax}}
	if float64(s.{{.Name}}) > {{.Validation.RangeMax}} {
		errs = append(errs, ValidationError{Field: "{{.Name}}", Message: fmt.Sprintf("value must be at most {{.Validation.RangeMax}}, got %v", s.{{.Name}})})
	}
{{- end}}
{{- end}}
{{- end}}
{{- if .Validation.IsPointer}}
	}
{{- end}}
{{- end}}
{{- end}}
	return errs
}
{{end}}
{{end}}
